!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cimo=e():t.cimo=e()}(window,(function(){return function(t){var e={};function a(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=e,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(o,r,function(e){return t[e]}.bind(null,r));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=2)}([function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._8BytesToDouble=e._3BytesToInt=e._2BytesToInt=e.doubleTo8Bytes=e.intTo3Bytes=e.intTo2Bytes=void 0,e.intTo2Bytes=function(t){return[(t=Math.round(t))>>8&255,255&t]},e.intTo3Bytes=function(t){return[(t=Math.round(t))>>16&255,t>>8&255,255&t]},e.doubleTo8Bytes=function(t){var e=new ArrayBuffer(8);new Float64Array(e)[0]=t;var a=new Int8Array(e);return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]]},e._2BytesToInt=function(t){return 256*t[0]+t[1]},e._3BytesToInt=function(t){return 256*t[0]*256+256*t[1]+t[2]},e._8BytesToDouble=function(t){var e=t.buffer.slice(t.byteOffset,t.byteLength+t.byteOffset);return new Float64Array(e)[0]}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.kDrawImageTag=e.kClipTag=e.kArcToTag=e.kArcTag=e.kBezierCurveToTag=e.kQuadraticCurveToTag=e.kRectTag=e.kMoveToTag=e.kLineToTag=e.kFillTag=e.kStrokeTag=e.kClosePathTag=e.kBeginPathTag=e.kClearRectTag=e.kStrokeRectTag=e.kFillRectTag=e.kSetShadowColorTag=e.kSetShadowBlurTag=e.kSetShadowOffsetYTag=e.kSetShadowOffsetXTag=e.kSetMiterLimitTag=e.kSetLineJoinTag=e.kSetLineCapTag=e.kSetLineWidthTag=e.kCreatePatternTag=e.kCreateRadialGradientTag=e.kAddColorStopTag=e.kCreateLinearGradientTag=e.kSetFillStyleTag=e.kSetStrokeStyleTag=e.kSetGlobalCompositeOperationTag=e.kSetGlobalAlphaTag=e.kSetTransformTag=e.kTransformTag=e.kTranslateTag=e.kRotateTag=e.kScaleTag=e.kRestoreTag=e.kSaveTag=e.kFileVersion=e.kFileTag=e.kinTag=e.kofTag=e.kTheTag=void 0,e.kTheTag=100,e.kofTag=100,e.kinTag=100,e.kFileTag=[89,69,90,73],e.kFileVersion=[0,1],e.kSaveTag=100,e.kRestoreTag=101,e.kScaleTag=102,e.kRotateTag=103,e.kTranslateTag=104,e.kTransformTag=105,e.kSetTransformTag=106,e.kSetGlobalAlphaTag=107,e.kSetGlobalCompositeOperationTag=108,e.kSetStrokeStyleTag=109,e.kSetFillStyleTag=110,e.kCreateLinearGradientTag=111,e.kAddColorStopTag=112,e.kCreateRadialGradientTag=113,e.kCreatePatternTag=114,e.kSetLineWidthTag=115,e.kSetLineCapTag=116,e.kSetLineJoinTag=117,e.kSetMiterLimitTag=118,e.kSetShadowOffsetXTag=119,e.kSetShadowOffsetYTag=120,e.kSetShadowBlurTag=121,e.kSetShadowColorTag=122,e.kFillRectTag=123,e.kStrokeRectTag=124,e.kClearRectTag=125,e.kBeginPathTag=126,e.kClosePathTag=127,e.kStrokeTag=128,e.kFillTag=129,e.kLineToTag=130,e.kMoveToTag=131,e.kRectTag=132,e.kQuadraticCurveToTag=133,e.kBezierCurveToTag=134,e.kArcTag=135,e.kArcToTag=136,e.kClipTag=137,e.kDrawImageTag=138},function(t,e,a){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=e.Decoder=e.Encoder=void 0;var s=a(3),n=a(4),i=a(5),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(s.Encoder);e.Encoder=p;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(n.Decoder);e.Decoder=y;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i.Renderer);e.Renderer=l},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Encoder=void 0;var o=a(1),r=a(0),s=function(){function t(t){this.options=t,this.frames=[[]]}return t.prototype.getMetaData=function(){var t=[];if(t.push.apply(t,r.intTo2Bytes(this.options.width)),t.push.apply(t,r.intTo2Bytes(this.options.height)),t.push(1==this.options.animation?1:0),t.push(void 0!==this.options.fps?this.options.fps:0),t.length<32)for(var e=t.length;e<32;e++)t.push(0);return t},t.prototype.save=function(){var t=this.frames[this.frames.length-1];t.push.apply(t,r.intTo2Bytes(o.kSaveTag)),t.push.apply(t,r.intTo2Bytes(0))},t.prototype.restore=function(){var t=this.frames[this.frames.length-1];t.push.apply(t,r.intTo2Bytes(o.kRestoreTag)),t.push.apply(t,r.intTo2Bytes(0))},t.prototype.scale=function(t,e){var a=this.frames[this.frames.length-1];a.push.apply(a,r.intTo2Bytes(o.kScaleTag)),a.push.apply(a,r.intTo2Bytes(16)),a.push.apply(a,r.doubleTo8Bytes(t)),a.push.apply(a,r.doubleTo8Bytes(e))},t.prototype.rotate=function(t){var e=this.frames[this.frames.length-1];e.push.apply(e,r.intTo2Bytes(o.kRotateTag)),e.push.apply(e,r.intTo2Bytes(8)),e.push.apply(e,r.doubleTo8Bytes(t))},t.prototype.translate=function(t,e){var a=this.frames[this.frames.length-1];a.push.apply(a,r.intTo2Bytes(o.kTranslateTag)),a.push.apply(a,r.intTo2Bytes(16)),a.push.apply(a,r.doubleTo8Bytes(t)),a.push.apply(a,r.doubleTo8Bytes(e))},t.prototype.transform=function(t,e,a,s,n,i){var p=this.frames[this.frames.length-1];p.push.apply(p,r.intTo2Bytes(o.kTransformTag)),p.push.apply(p,r.intTo2Bytes(48)),p.push.apply(p,r.doubleTo8Bytes(t)),p.push.apply(p,r.doubleTo8Bytes(e)),p.push.apply(p,r.doubleTo8Bytes(a)),p.push.apply(p,r.doubleTo8Bytes(s)),p.push.apply(p,r.doubleTo8Bytes(n)),p.push.apply(p,r.doubleTo8Bytes(i))},t.prototype.setTransform=function(t,e,a,s,n,i){var p=this.frames[this.frames.length-1];p.push.apply(p,r.intTo2Bytes(o.kSetTransformTag)),p.push.apply(p,r.intTo2Bytes(48)),p.push.apply(p,r.doubleTo8Bytes(t)),p.push.apply(p,r.doubleTo8Bytes(e)),p.push.apply(p,r.doubleTo8Bytes(a)),p.push.apply(p,r.doubleTo8Bytes(s)),p.push.apply(p,r.doubleTo8Bytes(n)),p.push.apply(p,r.doubleTo8Bytes(i))},t.prototype.setGlobalAlpha=function(t){var e=this.frames[this.frames.length-1];e.push.apply(e,r.intTo2Bytes(o.kSetGlobalAlphaTag)),e.push.apply(e,r.intTo2Bytes(8)),e.push.apply(e,r.doubleTo8Bytes(t))},t.prototype.setStrokeStyle=function(t,e,a,s){void 0===s&&(s=1);var n=this.frames[this.frames.length-1];n.push.apply(n,r.intTo2Bytes(o.kSetStrokeStyleTag)),n.push.apply(n,r.intTo2Bytes(4)),n.push(t,e,a,Math.floor(255*s))},t.prototype.setFillStyle=function(t,e,a,s){void 0===s&&(s=1);var n=this.frames[this.frames.length-1];n.push.apply(n,r.intTo2Bytes(o.kSetFillStyleTag)),n.push.apply(n,r.intTo2Bytes(4)),n.push(t,e,a,Math.floor(255*s))},t.prototype.setLineWidth=function(t){var e=this.frames[this.frames.length-1];e.push.apply(e,r.intTo2Bytes(o.kSetLineWidthTag)),e.push.apply(e,r.intTo2Bytes(8)),e.push.apply(e,r.doubleTo8Bytes(t))},t.prototype.setMiterLimit=function(t){var e=this.frames[this.frames.length-1];e.push.apply(e,r.intTo2Bytes(o.kSetMiterLimitTag)),e.push.apply(e,r.intTo2Bytes(8)),e.push.apply(e,r.doubleTo8Bytes(t))},t.prototype.setShadowOffsetX=function(t){var e=this.frames[this.frames.length-1];e.push.apply(e,r.intTo2Bytes(o.kSetShadowOffsetXTag)),e.push.apply(e,r.intTo2Bytes(8)),e.push.apply(e,r.doubleTo8Bytes(t))},t.prototype.setShadowOffsetY=function(t){var e=this.frames[this.frames.length-1];e.push.apply(e,r.intTo2Bytes(o.kSetShadowOffsetYTag)),e.push.apply(e,r.intTo2Bytes(8)),e.push.apply(e,r.doubleTo8Bytes(t))},t.prototype.setShadowBlur=function(t){var e=this.frames[this.frames.length-1];e.push.apply(e,r.intTo2Bytes(o.kSetShadowBlurTag)),e.push.apply(e,r.intTo2Bytes(8)),e.push.apply(e,r.doubleTo8Bytes(t))},t.prototype.setShadowColor=function(t,e,a,s){void 0===s&&(s=1);var n=this.frames[this.frames.length-1];n.push.apply(n,r.intTo2Bytes(o.kSetShadowColorTag)),n.push.apply(n,r.intTo2Bytes(4)),n.push(t,e,a,Math.floor(255*s))},t.prototype.fillRect=function(t,e,a,s){var n=this.frames[this.frames.length-1];n.push.apply(n,r.intTo2Bytes(o.kFillRectTag)),n.push.apply(n,r.intTo2Bytes(8)),n.push.apply(n,r.intTo2Bytes(t)),n.push.apply(n,r.intTo2Bytes(e)),n.push.apply(n,r.intTo2Bytes(a)),n.push.apply(n,r.intTo2Bytes(s))},t.prototype.strokeRect=function(t,e,a,s){var n=this.frames[this.frames.length-1];n.push.apply(n,r.intTo2Bytes(o.kStrokeRectTag)),n.push.apply(n,r.intTo2Bytes(8)),n.push.apply(n,r.intTo2Bytes(t)),n.push.apply(n,r.intTo2Bytes(e)),n.push.apply(n,r.intTo2Bytes(a)),n.push.apply(n,r.intTo2Bytes(s))},t.prototype.clearRect=function(t,e,a,s){var n=this.frames[this.frames.length-1];n.push.apply(n,r.intTo2Bytes(o.kClearRectTag)),n.push.apply(n,r.intTo2Bytes(8)),n.push.apply(n,r.intTo2Bytes(t)),n.push.apply(n,r.intTo2Bytes(e)),n.push.apply(n,r.intTo2Bytes(a)),n.push.apply(n,r.intTo2Bytes(s))},t.prototype.endFrame=function(){this.frames.push([])},t.prototype.build=function(){var t=[];return t.push.apply(t,o.kFileTag),t.push.apply(t,o.kFileVersion),t.push.apply(t,this.getMetaData()),this.frames.forEach((function(e,a){var o=[];o.push.apply(o,r.intTo3Bytes(a)),o.push.apply(o,r.intTo3Bytes(e.length)),o.push.apply(o,e),t.push.apply(t,o)})),new Uint8Array(t)},t}();e.Encoder=s},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=void 0;var o=a(0),r=function(){function t(t){if(this.data=t,this.frames=[],89!==t[0]||69!==t[1]||90!==t[2]||73!==t[3])throw"Invalid header check.";if(o._2BytesToInt([t[4],t[5]])>1)throw"Invalid version check.";this.readMetaData(),this.readFrames()}return t.prototype.readMetaData=function(){var t=this.data.subarray(6,38);this.width=o._2BytesToInt(t.subarray(0,2)),this.height=o._2BytesToInt(t.subarray(2,4)),this.animation=1==t[4],this.fps=t[5]},t.prototype.readFrames=function(){for(var t=38;t<this.data.length;){var e=o._3BytesToInt([this.data[t],this.data[t+1],this.data[t+2]]),a=o._3BytesToInt([this.data[t+3],this.data[t+4],this.data[t+5]]),r=this.data.subarray(t+6,t+6+a);this.frames[e]=r,t+=6+a}},t}();e.Decoder=r},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var o=a(1),r=a(0),s=function(){function t(t,e){this.decoder=t,this.renderingContext=e,this.decoder.width&&this.decoder.height&&(e.canvas.width=this.decoder.width,e.canvas.height=this.decoder.height),this.paint(0)}return t.prototype.paint=function(t){this.renderingContext.clearRect(0,0,this.renderingContext.canvas.width,this.renderingContext.canvas.height);var e=this.decoder.frames[t];console.log(this.decoder.frames);for(var a=0;a<e.length;){var s=r._2BytesToInt([e[a],e[a+1]]),n=r._2BytesToInt([e[a+2],e[a+3]]),i=e.subarray(a+4,a+4+n);switch(s){case o.kSaveTag:this.renderingContext.save();break;case o.kRestoreTag:this.renderingContext.restore();break;case o.kScaleTag:var p={x:r._8BytesToDouble(i.subarray(0,8)),y:r._8BytesToDouble(i.subarray(8,16))},y=p.x,l=p.y;this.renderingContext.scale(y,l);break;case o.kRotateTag:var u=r._8BytesToDouble(i.subarray(0,8));this.renderingContext.rotate(u);break;case o.kTranslateTag:var h={x:r._8BytesToDouble(i.subarray(0,8)),y:r._8BytesToDouble(i.subarray(8,16))};y=h.x,l=h.y;this.renderingContext.translate(y,l);break;case o.kTransformTag:var T={a:r._8BytesToDouble(i.subarray(0,8)),b:r._8BytesToDouble(i.subarray(8,16)),c:r._8BytesToDouble(i.subarray(16,24)),d:r._8BytesToDouble(i.subarray(24,32)),e:r._8BytesToDouble(i.subarray(32,40)),f:r._8BytesToDouble(i.subarray(40,48))},f=T.a,g=T.b,d=T.c,c=T.d,k=T.e,b=T.f;this.renderingContext.transform(f,g,d,c,k,b);break;case o.kSetTransformTag:var B={a:r._8BytesToDouble(i.subarray(0,8)),b:r._8BytesToDouble(i.subarray(8,16)),c:r._8BytesToDouble(i.subarray(16,24)),d:r._8BytesToDouble(i.subarray(24,32)),e:r._8BytesToDouble(i.subarray(32,40)),f:r._8BytesToDouble(i.subarray(40,48))};f=B.a,g=B.b,d=B.c,c=B.d,k=B.e,b=B.f;this.renderingContext.setTransform(f,g,d,c,k,b);break;case o.kSetGlobalAlphaTag:var S=r._8BytesToDouble(i.subarray(0,8));this.renderingContext.globalAlpha=S;break;case o.kSetStrokeStyleTag:var v={r:i[0],g:i[1],b:i[2],a:i[3]},m=v.r,_=v.g;g=v.b,f=v.a;this.renderingContext.strokeStyle="rgba("+m+","+_+","+g+","+f/255+")";break;case o.kSetFillStyleTag:var C={r:i[0],g:i[1],b:i[2],a:i[3]};m=C.r,_=C.g,g=C.b,f=C.a;this.renderingContext.fillStyle="rgba("+m+","+_+","+g+","+f/255+")";break;case o.kSetLineWidthTag:var w=r._8BytesToDouble(i.subarray(0,8));this.renderingContext.lineWidth=w;break;case o.kSetMiterLimitTag:w=r._8BytesToDouble(i.subarray(0,8));this.renderingContext.miterLimit=w;break;case o.kSetShadowOffsetXTag:w=r._8BytesToDouble(i.subarray(0,8));this.renderingContext.shadowOffsetX=w;break;case o.kSetShadowOffsetYTag:w=r._8BytesToDouble(i.subarray(0,8));this.renderingContext.shadowOffsetY=w;break;case o.kSetShadowBlurTag:w=r._8BytesToDouble(i.subarray(0,8));this.renderingContext.shadowBlur=w;break;case o.kSetShadowColorTag:var x={r:i[0],g:i[1],b:i[2],a:i[3]};m=x.r,_=x.g,g=x.b,f=x.a;this.renderingContext.shadowColor="rgba("+m+","+_+","+g+","+f/255+")";break;case o.kFillRectTag:var D={x:r._2BytesToInt([i[0],i[1]]),y:r._2BytesToInt([i[2],i[3]]),width:r._2BytesToInt([i[4],i[5]]),height:r._2BytesToInt([i[6],i[7]])},R=(y=D.x,l=D.y,D.width),O=D.height;this.renderingContext.fillRect(y,l,R,O);break;case o.kStrokeRectTag:var I={x:r._2BytesToInt([i[0],i[1]]),y:r._2BytesToInt([i[2],i[3]]),width:r._2BytesToInt([i[4],i[5]]),height:r._2BytesToInt([i[6],i[7]])};y=I.x,l=I.y,R=I.width,O=I.height;this.renderingContext.strokeRect(y,l,R,O);break;case o.kClearRectTag:var M={x:r._2BytesToInt([i[0],i[1]]),y:r._2BytesToInt([i[2],i[3]]),width:r._2BytesToInt([i[4],i[5]]),height:r._2BytesToInt([i[6],i[7]])};y=M.x,l=M.y,R=M.width,O=M.height;this.renderingContext.clearRect(y,l,R,O)}a+=4+n}},t}();e.Renderer=s}])}));